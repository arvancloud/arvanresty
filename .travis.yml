sudo: required

language: c

services:
  - docker

os:
  - linux

env:
  - VERSION=1.15.6.1rc0
  
before_install:
  - OPENSSL_VER=1.1.0j
  - ROOT=$(pwd)
  - sudo apt-get update
  - sudo apt-get install dos2unix curl
  - mkdir -p /tmp
  - mkdir -p /opt
  - mkdir -p /opt/openssl
  - curl -fsSL https://www.openssl.org/source/openssl-1.1.0j.tar.gz -o /tmp/openssl.tar.gz
  - tar -C /opt/openssl -xzf /tmp/openssl.tar.gz --strip-components 1
  - cd /opt/openssl
  - ls 
  - ./config --prefix=/usr --openssldir=/etc/ssl --libdir=lib shared zlib-dynamic
  - sudo make 1> /dev/null
  - sudo make install_sw 1> /dev/null

script:
  - cd $ROOT/openresty-$VERSION
  - ./configure
  - sudo make
  - sudo make install
